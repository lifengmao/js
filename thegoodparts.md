# JavaScript语言精粹 By Douglas Croford



---

## 语法（Grammar）

### 空白

空白可能表现为被格式化的字符或注释的形式。

Js中的注释有两种形式： /* ... */ （块注释）和 //（行注释）。

块注释对于被注释的代码块来说是不安全的，建议避免使用块注释。

### 标识符

标识符由一个字母开头，其后可选择性地加上一个或多个字母、数字或下划线。 标识符不能使用以下保留字：

> abstract 
boolean break byte
case catch char class const continue 
debugger default delete do double
else enum export extends
false final finally float for function
goto
if implement import in instanceof int interface
long native new null 
package private projected public
return
short static super switch synchronized
this throw throws transient true try typeof
var volatile void
while with

js不允许使用保留字来命名变量或参数。更糟糕的是，它不允许对象字面量或者用点运算符提取对象属性时，使用保留字作为对象的属性名。

### 数字

JS只有一个数字类型。它在内部被标示为64位的浮点数，和Java中的double数字类型一样

NaN是一个数值，它不等于任何值，包括它自身，要检测NaN需要使用函数isNaN()。

### 字符串

JS没有字符类型，要表示一个字符，只需要创建一个仅包含一个字符的字符串即可。

字符串是不可变的。一单字符串被创建，就永远无法改变它。

### 语句

当var语句被用在函数内部时，它定义的是这个函数的私有变量

变量应该定义在函数的头部，不应该定义在代码块中。

以下列出的值被当做假值：

 - false
 - null
 - undefined
 - 字符串''
 - 数字0
 - 数字NaN
 
除此之外的其他值都是真值。

---

## 对象

JavaScript中的对象是可变的键控集合，在js中，数组是对象，函数也是对象，正则表达式同样是对象。

JavaScript中的对象是无类型的。它对新属性的名字和属性的值都没有限制。

JavaScript包含一种原型链的特性，允许对象继承另一个对象的属性。正确使用它能减少对象初始化时消耗的时间和内存。

### 对象字面量

对象字面量提供了一种非常方便地创建新对象值的表示法。一个对象字面量就是包围在一对花括号中的零个或多个“名值”对。

在对象字面量中，如果属性名是一个合法的JavaScript标识符且不是保留字，则并不强制要求用引号括住属性名。

### 检索

要检索对象里包含的值，可以使用在[]后缀中括住一个字符串表达式的方法。如果字符串表达式是一个字符串字面量，而且它是一个合法的JavaScript标识符且不是保留字。那么可以使用.表示法代替。优先考虑.表示法。

可以使用||运算符来填充默认值，通过&&运算符来避免错误。

### 原型

每个对象都连接到一个原型对象，并且它可以从中继承属性。所有通过对象字面量创建的对象都连接到Object.prototype，它是JavaScript中的标配对象。

原型连接在更新时是不起作用的。当我们对某个对象做出改变时，不会触及该对象的原型。

原型连接只有在检索值时才会用到。

> 如果我们尝试去获取对象的某个属性值，但该对象没有此属性名，那么JavaScript会试着从原型对象中获取属性值。如果原型对象也没有属性值。那么再从该原型对象的原型中寻找，依次类推，直至该过程最后到达终点Object.prototype。如果属性完全不存在与原型链中，那么结果就是undefined。这个过程称为委托

## 函数

### 函数对象
JavaScript中函数就是对象。函数对象连接到Function.prototype（该原型对象本身连接到Object.prototype）。每个函数在创建时会附加两个隐藏属性：函数的上下文和事先函数行为的代码。
每个函数对象在创建时也随配一个prototype属性。它的值是一个拥有constructor属性且值即为该函数的对象。
函数的与众不同之处在于它们可以被调用。

### 函数字面量

函数对象通过函数字面量来创建：

    //创建一个名为add的变量，并用来把两个数字相加的函数赋值给它。
    var add = function(a,b) {
        return a + b;
    };

函数字面量包含四个部分：

 1. 保留字 function
 2. 函数名
 3. 包围在圆括号中的一组参数
 4. 包围在花括号中的一组语句
 
**函数也可以被定义在其它函数中。一个内部函数除了可以访问自己的参数和变量，同时它也能自由访问把它嵌套在其中的父函数的参数和变量。通过函数字面量创建的函数对象包含一个连到外部上下文的连接。这被称为闭包**

### 调用

调用一个函数会暂停当前函数的执行，传递控制权和参数给新函数。除了声明时定义的形式参数，每个函数还接收两个参数：this和arguments（arguments在ES6中已经废弃）。参数this在面向对象编程中非常重要，它的值取决于调用的模式。

在JavaScript中一共有四种调用模式：

 - 方法调用模式：当一个函数被保存为对象的一个属性时，我们称它为一个方法。当一个方法被调用时，this被绑定到该对象，方法可以使用this访问自己所属的对象，所以它能从对象中取值或对对象进行修改。通过this可取得它们所属对象的上下文的方法称为公共方法（public method）。
 - 函数调用模式：当一个函数并非一个对象的属性时，那么它就是被当做一个函数来调用的，以此模式调用函数时，**this绑定到全局对象。**
 - 构造器调用模式：如果在一个函数前面带上new来调用，那么背地里将会**创建一个连接到该函数的prototype成员的新对象**，同时**this会被绑定到这个新对象上**。
 - apply调用模式：apply方法让我们构建一个参数数组传递给调用函数，它接收两个参数，**第一个是要绑定给this的值**，第二个就是参数数组。
 
### 参数

当函数被调用时，会得到一个“免费”配送的参数，那就是arguments数组。函数可以通过此参数访问所有它被调用时传递给它的参数列表，包括哪些没有被分配给函数声明时定义的形式参数的多余参数。

**arguments并不是一个真正的数组。它只是一个类数组。它拥有一个length属性，但它没有任何数组的方法。**

### 返回

一个函数总会返回一个值，如果没有指定的返回值，则返回undefined。

### 闭包

在编程语言中，作用域控制着变量与参数的可见性及生命周期。作用域的好处是内部函数可以访问定义它们的外部函数的参数和变量。并且内部函数拥有比它的外部函数更长的生命周期。

我们可以使用闭包和函数来构造模块。模块是一个提供接口却隐藏状态与实现的函数或对象。它的一般形式是：一个定义了私有变量和函数的函数；利用闭包创建可以访问私有变量和函数的特权函数；最后返回这个特权函数，或者把他们保存到一个可以访问的地方。

### 柯里化

柯里化允许我们把函数与传递给它的参数相结合，产生出一个新的函数。

    var add1 = add.curry(1);
    document.writeln(add1(6)); //7



 


 
